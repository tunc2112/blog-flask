{% extends "core.html" %}

{% set description = "All posts" %}
{% if filter_category %}
	{% set description = description + " with category [%s]" % filter_category %}
{% endif %}

{% if filter_tag %}
	{% set description = description + " with tag #" + filter_tag %}
{% endif %}

{% set title = description %}

{% macro create_posts_list(posts, filter_category=None, filter_tag=None) %}
	<ul class="list-group">
	{% for post in posts %}
		{% if (not filter_category or filter_category == post.category) and (not filter_tag or filter_tag in post.tags) %}
			<li class="list-group-item" style="line-height: 2rem;">
				<span style="font-size: 1.5rem;">
					{% if post.pinned is sameas true %}
						<span class="badge badge-primary"><i class="fa fa-thumb-tack"></i></span>
					{% endif %}
					<a href="/posts/{{ post.path }}" style="color: black;">{{ post.title }}</a>
				</span>
				<small style="color: #888;">{{ post.date }}</small>
			    <br>
				<a class="btn btn-success tag_badge" href="/categories/{{ post.category }}" role="button">
					<i class="fa fa-code-fork"></i> {{ post.category }}
				</a>
				{% for tag in post.tags %}
					<a class="btn btn-secondary tag_badge" href="/tags/{{ tag }}" role="button">{{ tag }}</a>
				{% endfor %}
			</li>
		{% endif %}
	{% endfor %}
	</ul>
{% endmacro %}

{% block container %}
<h3>{{ description }}</h3>
{{ create_posts_list(posts, filter_category, filter_tag) }}
{% endblock container %}
